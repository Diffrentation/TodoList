# Environment Variables Reference

This document describes all environment variables used in the application.

## Required Variables

### `MONGODB_URI`
- **Type**: String
- **Required**: Yes
- **Description**: MongoDB connection string
- **Examples**:
  - Local: `mongodb://localhost:27017/todolist`
  - Atlas: `mongodb+srv://username:password@cluster.mongodb.net/todolist?retryWrites=true&w=majority`

### `JWT_SECRET`
- **Type**: String
- **Required**: Yes
- **Description**: Secret key for signing JWT access tokens
- **Minimum Length**: 32 characters
- **Generation**: Use `openssl rand -base64 32` or auto-generated by `npm run setup-env`
- **Security**: Must be unique and kept secret. Never commit to version control.

### `JWT_REFRESH_SECRET`
- **Type**: String
- **Required**: Yes
- **Description**: Secret key for signing JWT refresh tokens
- **Minimum Length**: 32 characters
- **Generation**: Use `openssl rand -base64 32` or auto-generated by `npm run setup-env`
- **Security**: Must be unique and kept secret. Never commit to version control.

## Optional Variables

### `SMTP_HOST`
- **Type**: String
- **Required**: No
- **Default**: `smtp.gmail.com`
- **Description**: SMTP server hostname for sending OTP emails
- **Examples**:
  - Gmail: `smtp.gmail.com`
  - Outlook: `smtp-mail.outlook.com`
  - Yahoo: `smtp.mail.yahoo.com`

### `SMTP_PORT`
- **Type**: Number (as string)
- **Required**: No
- **Default**: `587`
- **Description**: SMTP server port
- **Common Values**: `587` (TLS), `465` (SSL), `25` (unencrypted)

### `SMTP_USER`
- **Type**: String
- **Required**: No
- **Description**: Email address for sending OTP emails
- **Note**: If not set, OTPs will be logged to console in development mode

### `SMTP_PASS`
- **Type**: String
- **Required**: No
- **Description**: Email password or app-specific password
- **Note**: For Gmail, use an app-specific password, not your regular password
- **Security**: Keep this secret. Never commit to version control.

### `NODE_ENV`
- **Type**: String
- **Required**: No
- **Default**: `development`
- **Values**: `development` | `production`
- **Description**: Environment mode
- **Effects**:
  - `development`: Cookies use `secure: false`, OTPs logged to console if email not configured
  - `production`: Cookies use `secure: true`, requires HTTPS

## Setup Instructions

### Quick Setup
```bash
npm run setup-env
```

This will:
1. Create `.env.local` from `env.template`
2. Auto-generate secure JWT secrets
3. Set default values for optional variables

### Manual Setup
1. Copy `env.template` to `.env.local`
2. Update required variables
3. Optionally configure email settings

## Security Best Practices

1. **Never commit `.env.local`** - It's already in `.gitignore`
2. **Use strong secrets** - Minimum 32 characters, use random generation
3. **Different secrets for production** - Never reuse development secrets
4. **Rotate secrets periodically** - Especially if compromised
5. **Use app passwords** - For Gmail, use app-specific passwords, not your main password
6. **Environment-specific configs** - Use different values for dev/staging/production

## Production Checklist

- [ ] `MONGODB_URI` points to production database
- [ ] `JWT_SECRET` is a strong random string (32+ characters)
- [ ] `JWT_REFRESH_SECRET` is a strong random string (32+ characters)
- [ ] `SMTP_USER` and `SMTP_PASS` are configured
- [ ] `NODE_ENV` is set to `production`
- [ ] All secrets are stored securely (not in code)
- [ ] HTTPS is enabled (required for `secure: true` cookies)

## Troubleshooting

### MongoDB Connection Issues
- Verify `MONGODB_URI` is correct
- Check network access (for Atlas)
- Ensure MongoDB is running (for local)

### JWT Errors
- Verify `JWT_SECRET` and `JWT_REFRESH_SECRET` are set
- Ensure secrets are at least 32 characters
- Check for typos in variable names

### Email Not Sending
- Verify `SMTP_USER` and `SMTP_PASS` are set
- Check SMTP credentials are correct
- For Gmail, ensure app-specific password is used
- Check firewall/network restrictions
- In development, check console for OTP (if email not configured)

### Cookie Issues
- In production, ensure `NODE_ENV=production` and HTTPS is enabled
- Check browser console for cookie errors
- Verify `sameSite` and `secure` settings match your setup

